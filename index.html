<!doctype html>
<html>
	<head>
    	<title>OneShot</title>

		<script src='oneShot.js'></script>
	</head>
	<body>	
		<canvas id="oneShotCanvas"></canvas>	
		<pre></pre>

		<script>
			const oneShot = new OneShot('oneShotCanvas');

            const code = 
			`
				# This is a comment
				WINDOW 400, 400

				IF (RANDOM() > 0.5) THEN
					PRINT "WOW"
				END

				PRINT(INT("1.5") + 1)
				PRINT(MAX(2, 5))
				PRINT(ABS(-5.1))
				PRINT(FLOOR(5.5))
				PRINT(CEIL(5.5))
				PRINT(LERP(0, 11, 1))

				COLOR "lightgrey"
				FILL ALL

				SPRITE "Hero"
					SIZE 12, 12
					FRAME "Front"
						COLORDATA "#", "black"
						COLORDATA ".", "#FC9"
						COLORDATA "-", "#9999CC"
						PIXELDATA "    ####    "
						PIXELDATA "  ##....##  "
						PIXELDATA " #........# "
						PIXELDATA " #........# "
						PIXELDATA " #.##..##.# "
						PIXELDATA " #........# "
						PIXELDATA " #...##...# "
						PIXELDATA "  #......#  "
						PIXELDATA " #-######-# "
						PIXELDATA "#.#------#.#"
						PIXELDATA " ##--##--## "
						PIXELDATA "   ##  ##   "
					END
				END

				SONG "Test"
					BPM 480
					LOOP TRUE

					SHEET
						GAIN 20
						TYPE "sine"
						BAR "C4 D4 E4 F4 G4"
					END
				END

				LET X = 0
				LET Y = 0
				LET RUNNING = TRUE
				LET FPS = 60

				WHILE RUNNING THEN
					FILL ALL
					DRAW X, Y, "Hero", "Front"

					IF (INPUT("W")) THEN
						Y = Y - 1
					END

					IF (INPUT("A")) THEN
						X = X - 1
					END

					IF (INPUT("S")) THEN
						Y = Y + 1
					END

					IF (INPUT("D")) THEN 
						X = X + 1
					END

					# Close game
					IF (INPUT("ESCAPE")) THEN
						RUNNING = FALSE
					END

					SLEEP 1000 / FPS
				END

				PRINT "End of game"
			`;

			oneShot.onPrint = (message) => {
                document.querySelector('pre').innerText += `> ${message}\n`;
			}

			oneShot.run(code);
		</script>
	</body>
</html>
